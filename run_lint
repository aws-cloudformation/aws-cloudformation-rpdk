#!/bin/bash
set -euo pipefail
IFS=$'\n\t'

PACKAGE="uluru/"
TESTS="tests/"
FILES=("setup.py" "$PACKAGE" "$TESTS")

echo "--- Automatically fixing up imports using isort ---"
isort -rc -y "${FILES[@]}"

echo "--- Formatting code with black ---"
black "${FILES[@]}"

echo "--- Linting code with flake8 ---"
flake8 "${FILES[@]}"

echo "--- Linting code with pylint ---"
pylint "${FILES[@]}"

echo "--- Running safety tests ---"
bandit -r "$PACKAGE"

echo "--- Running unit tests ---"
pytest --cov="$PACKAGE" --doctest-modules "$PACKAGE" "$TESTS"

echo "PASS"
